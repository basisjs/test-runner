<!doctype html>

<html>

<head>
  <meta charset="utf-8">
  <title>Basis.js Test Runner â€“ Showcase</title>

  <style>
    HTML,
    BODY
    {
      background: #F0F0F0;
      padding: 0;
      margin: 0;
      height: 100%;
    }
    BODY
    {
      overflow-y: scroll;
    }
  </style>

  <!--<link rel="stylesheet" href="../build/style.css">
  <script src="../build/basis.js"></script>-->
  <script src="../bower_components/basisjs/src/basis.js" data-basis-config="
    autoload: '../src/reporter/app',
    path: {
      core: '../src',
      esprima: '../bower_components/esprima',
      diff: '../bower_components/jsdiff'
    },
    extProto: false,
    exports: true
  "></script>
</head>

<body>
  <div id="test-runner" style="border: 1px solid black; margin: 10px;">
  </div>
  <script>
    basisjsTestRunner.setup({
      element: document.getElementById('test-runner'),
      baseURI: '../build/'
    });
    basisjsTestRunner.loadTests({
      name: 'Showcase',
      test: [
        {
          name: 'Test done',
          test: function(){
            assert(true, true);
          }
        },
        {
          name: 'Comparison',
          test: [
            {
              name: 'Non-strict comparation',
              test: function(){
                assert(12.34, 12.34);
                assert({ a: 1, b: 2 }, { b: 2, a: 1 });
                assert([1, 2, 3], [1, 2, 3]);
                assert(/foo/, /foo/);
                assert(new Date, new Date);
                assert(new String, new String);
                assert(new Number, new Number);
                assert(new Boolean, new Boolean);
                assert(NaN, NaN);
                assert(
                  function(){ return 123; },
                  function(){ return 123; }
                );
                assert(
                  function(){
                    function foo(){
                      return location;
                    };
                    assert(1, 1);
                    return foo();
                  },
                  function(){
                    function foo(){
                      return location;
                    };
                    assert(1, 1);
                    return foo();
                  }
                );

                var foo = function(){ return assert(1, 1) };
                assert(function(){ return assert(1, 1) }, foo);

                // function bar(){ return assert(1, 1); };
                // assert(function bar(){ return assert(1, 1); }, bar);
              }
            },
            {
              name: 'Failures',
              test: function(){
                assert(true, false)
                assert({ a: 1, b: 2 }, { a: 1, c: 2 });
                assert([{ a: 1 }], [{ a: 1 }]);
                assert([1, 2], [2, 3]);
                assert(/foo/, /bar/);
                assert(/foo/g, /foo/);
                assert('This is expected string', 'This is actual string');
                assert(new Date(0), new Date(2000));
                assert(new String('foo'), new String('bar'));
                assert(new Number(1), new Number(2));
                assert(new Boolean(true), new Boolean(false));
              }
            }
          ]
        },
        {
          name: 'Exception',
          test: function(){
            var foo = 123;

            // exception on that line
            foo.exception();

            assert(123, foo);
          }
        },
        {
          name: 'Exception inside function',
          test: function(){
            [1, 2, 3].forEach(function(){
              // exception on that line
              assert(0, ++test);
            });

            assert(true, true);
          }
        },
        {
          name: 'Pending',
          test: [
            {
              name: 'Empty tests are pending',
              test: function(){}
            },
            {
              name: 'Tests with no `test` property are pending'
            },
            {
              name: 'Tests with no assertions are pending',
              test: function(){
                var nothing;
              }
            },
            {
              name: 'Tests marked as pending are pending and doesn\'t execute',
              pending: true,
              test: function(){
                assert(true, true);
              }
            },
            {
              name: 'Empty test suites are pending',
              test: []
            },
            {
              name: 'Empty test suites with only pending tests are OK',
              test: [
                {
                  name: 'Test with empty test function',
                  test: function(){}
                },
                {
                  name: 'Test with no test'
                }
              ]
            }
          ]
        },
        {
          name: 'Async (tests may nest)',
          test: [
            {
              name: 'Test with done callback',
              test: function(done){
                assert(true, true);
                done();
              }
            },
            {
              name: 'Test with done callback that never called fails by timeout',
              test: function(done){
                assert(true, true);
              }
            },
            {
              name: 'this.async()',
              test: function(){
                var num = 0;

                this.async(function(){
                  assert(2, ++num);
                });

                this.async(function(){
                  assert(3, ++num);
                });

                assert(1, ++num);
              }
            },
            {
              name: 'nested this.async()',
              test: function(){
                var num = 0;

                this.async(function(){
                  assert(2, ++num);
                  this.async(function(){
                    assert(4, ++num);
                    this.async(function(){
                      assert(5, ++num);
                    });
                  });
                });

                this.async(function(){
                  assert(3, ++num);
                });

                assert(1, ++num);
              }
            },
            {
              name: 'this.async() should not cause on exception',
              test: function(){
                var num = 0;

                this.async(function(){
                  assert(1, ++num);
                });

                assert(true, ++exception);
              }
            },
            {
              name: 'first exception in this.async() should stops others',
              test: function(){
                this.async(function(){
                  assert(1, ++num);
                });

                this.async(function(){
                  assert(2, ++num);
                });
              }
            },
            {
              name: 'this.async() that infinitely call async fails by timeout',
              test: function(){
                this.async(function infinite(){
                  this.async(infinite);
                });
              }
            }
          ]
        }
      ]
    });
    basisjsTestRunner.run();
  </script>
</body>
</html>