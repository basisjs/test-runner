<!doctype html>

<html>

<head>
  <meta charset="utf-8">
  <title>Basis Test Suite</title>

  <style>
    HTML,
    BODY
    {
      background: #F0F0F0;
      padding: 0;
      margin: 0;
      height: 100%;
    }
    BODY
    {
      overflow-y: scroll;
    }

    .hide-frame
    {
      position: absolute;
      top: -100px;
      left: -100px;
      height: 10px;
      width: 10px;
    }
  </style>

  <script>
    /**@cut*/ var startTime = new Date;
  </script>
  <script src="../bower_components/basisjs/src/basis.js" data-basis-config="
    autoload: 'reporter/app',
    path: {
      core: '.',
      esprima: '../bower_components/esprima',
      diff: '../bower_components/jsdiff'
    },
    extProto: false,
    exports: true
  "></script>
</head>

<body>
  <script>
    (function(){
      var app = basis.require('./reporter/app.js');
      var params = location.search.replace(/^\?/, '').split('&').reduce(function(res, pair){
        var parts = pair.split('=');
        res[parts.shift()] = parts.join('=');
        return res;
      }, {});

      if (!params.page)
      {
        document.write('Test suite is not specified. Add to page url `?page=path/to/test-suite.html`');
      }
      else
      {
        var iframe = document.createElement('iframe');
        iframe.src = params.page;
        iframe.className = 'hide-frame';
        iframe.onload = function(){
          if (typeof this.contentWindow.loadTests == 'function')
          {
            /**@cut*/ var t = new Date;
            this.contentWindow.loadTests(app.loadTests);
            /**@cut*/ document.title = (new Date - t) + '/' + (new Date - startTime);
          }
        }
        basis.doc.body.add(iframe);

        app.setup({
          element: document.body,
          baseURI: basis.path.baseURI
        });
      }
    })();
  </script>
</body>
</html>
